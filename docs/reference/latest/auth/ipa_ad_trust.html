<!DOCTYPE html>
<html>

  <head>
  <!DOCTYPE html>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ManageIQ</title>
  <meta name="description" content="">
  <meta property="og:image" content="http://manageiq.org/assets/images/logo/manageiq-logo-blue.png" />

  <link type="text/css" rel="stylesheet" href="/assets/main-8de063b063e781c83c3900f2fb42692885edeac0346d54e22467184ccc393942.css">
  <link rel="canonical" href="http://manageiq.org/docs/reference/latest/auth/ipa_ad_trust.html">
  <link rel="alternate" type="application/rss+xml" title="ManageIQ" href="http://manageiq.org/feed.xml">

  <link href="/assets/images/favicon.ico" rel="shortcut icon">
</head>


  <body>
    <header class="site-header">
  <a href="/" class="brand">
    <span class="brand-name">ManageIQ</span>
    <img class="brand-logo" src="/assets/images/manageiq-logo-inverse.svg" alt="ManageIQ Logo">
  </a>

  <div id="site_header-nav_toggle">
    <a href="#" class="off_canvas-show" data-behavior="off_canvas-toggle">
      <i class="fa fa-bars"></i>
    </a>
  </div>

  <div class="off_canvas">
    <header class="off_canvas-header">
      <a href="#" class="off_canvas-hide" data-behavior="off_canvas-toggle">
        <i class="fa fa-times"></i>
      </a>
    </header>

    <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

  </div>
</header>


    <main data-url="/docs/reference/latest/auth/ipa_ad_trust">
      <nav class="doc_tabs">
  <ul>
  <li>
    <a href="/docs/get-started/">Get Started</a>
  </li>
  <li class="active">
    <a href="/docs/reference/">User Reference</a>
  </li>
  <li>
    <a href="/docs/automation">
      Automation Book
    </a>
  </li>
  <li>
    <a href="/docs/api">
      API Docs
    </a>
  </li>
  <li>
    <a href="/docs/guides/README">Developer Guides</a>
  </li>
</ul>

    <div class="col-lg-4 col-md-4 col-sm-12 pull-right" style="margin-top: 10px">
        <script async src="https://cse.google.com/cse.js?cx=006042792541147862616:dfkijfebdts"></script>
         <div class="gcse-search"></div>
    </div>
</nav>

<script>
  window.onload = demo;
	function demo() {
	    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search Documentation")
	}
</script>

<div class="doc_container">
  <div class="doc_menu">
    
    

<div class="doc_menu-heading">
  Latest
</div>

<ul class="menu menu-toplevel" id=ref_menu_latest>


  <li class="menu-parent">
    
    <a href="#">
      Installation
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_aws/index.html">
      Amazon Web Services (AWS)
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_microsoft_azure/index.html">
      Microsoft Azure
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_google_compute_engine/index.html">
      Google Compute Engine
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_vmware_vsphere/index.html">
      VMware vSphere
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_red_hat_enterprise_linux_openstack_platform/index.html">
      Red Hat Enterprise OpenStack Platform
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_red_hat_virtualization/index.html">
      Red Hat Enterprise Virtualization
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/installing_on_scvmm/index.html">
      Microsoft System Center Virtual Machine Manager (SCVMM)
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Configuration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/deployment_planning_guide/index.html">
      Deployment Planning Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/general_configuration/index.html">
      General Configuration
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/high_availability_guide/index.html">
      High Availability Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/appliance_hardening_guide/index.html">
      Appliance Hardening Guide
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Administration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/monitoring_alerts_and_reporting/index.html">
      Monitoring, Alerts, and Reporting
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/policies_and_profiles_guide/index.html">
      Policies and Profiles Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/managing_infrastructure_and_inventory/index.html">
      Managing Infrastructure and Inventory
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/managing_providers/index.html">
      Managing Providers
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/provisioning_virtual_machines_and_hosts/index.html">
      Provisioning Virtual Machines and Hosts
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/scripting_actions/index.html">
      Scripting Actions in ManageIQ
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Authentication
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/auth/active_directory.html">
      Active Directory
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/auth/ipa_2fa.html">
      2-Factor-Authentication with IPA
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item active">
    <a href="/docs/reference/latest/auth/ipa_ad_trust.html">
      IPA/AD Trust
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/auth/ldap.html">
      LDAP
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/auth/saml.html">
      SAML
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/auth/openid_connect.html">
      OpenID-Connect
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Integration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/integration_with_aws_cloudformation_and_openstack_heat/index.html">
      AWS CloudFormation and OpenStack Heat
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/integration_with_servicenow/index.html">
      ServiceNow
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Reference
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/capabilities_matrix/index.html">
      Capabilities Matrix
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/rest_api/index.html">
      ManageIQ REST API
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/latest/methods_available_for_automation/index.html">
      Methods Available for Automation
    </a>
    
  </li>


      </ul>
    
  </li>

</ul>

    
  </div>
  <div class="doc_main">
    <article class="doc user_doc">
      

      <div class="doc-content">
        
        <div class="doc-versions">
          <span class="label">Versions: </span>
          
            <span class="active" >
              <a href="/docs/reference/latest/auth/ipa_ad_trust.html">
                Latest
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/jansa/auth/ipa_ad_trust.html">
                Jansa
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/ivanchuk/auth/ipa_ad_trust.html">
                Ivanchuk
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/hammer/auth/ipa_ad_trust.html">
                Hammer
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/gaprindashvili/auth/ipa_ad_trust.html">
                Gaprindashvili
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/fine/auth/ipa_ad_trust.html">
                Fine
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span>
              <a href="/docs/reference/euwe/auth/ipa_ad_trust.html">
                Euwe
              </a>
            </span>
            
          
        </div>
        
        <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#ipaad-trust-authentication">IPA/AD Trust Authentication</a></li>
<li class="toc-entry toc-h2"><a href="#requirements">Requirements</a></li>
<li class="toc-entry toc-h2"><a href="#set-up-and-configure-an-ipa-server-for-ad-trust-authentication">Set up and configure an IPA server for AD Trust Authentication</a></li>
<li class="toc-entry toc-h2"><a href="#enable-the-miq-appliance-to-use-the-configued-ipa-server">Enable the MiQ Appliance to use the configued IPA server</a></li>
<li class="toc-entry toc-h2"><a href="#configure-the-miq-appliance-to-use-external-authentication">Configure the MiQ appliance to use external authentication</a></li>
<li class="toc-entry toc-h2"><a href="#create-groups-on-the-miq-appliance">Create groups on the MiQ appliance</a></li>
<li class="toc-entry toc-h2"><a href="#use-ad-trust-authentication">Use AD Trust Authentication</a></li>
</ul><h2 id="ipaad-trust-authentication">
<a class="anchor" href="#ipaad-trust-authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>IPA/AD Trust Authentication</h2>

<p>Active Directory (AD) Trust Authentication on the Appliance is supported
with External Authentication to IPA.</p>

<p>In this guide we will cover how to manually configure an Appliance’s
external authentication to work with AD Trust Authentication using IPA.
This provides IPA Users access to the Appliance Administrative UI and
the REST API using their AD credentials.</p>

<ol>
  <li>
    <p><a href="#requirements">Requirements</a></p>
  </li>
  <li>
    <p><a href="#configure-ipa-ad-trust-server">Set up and configure an IPA server for AD Trust
Authentication</a></p>
  </li>
  <li>
    <p><a href="#enable-external-auth">Enable the MiQ Appliance to use the configued IPA
server</a></p>
  </li>
  <li>
    <p><a href="#configure-admin-ui">Configure the MiQ appliance to use external
authentication</a></p>
  </li>
  <li>
    <p><a href="#create-group-ui">Create groups on the MiQ appliance</a></p>
  </li>
  <li>
    <p><a href="#use-ad-trust">Use AD Trust Authentication</a></p>
  </li>
</ol>

<h2 id="requirements">
<a class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>The following is needed in order to enable AD Trust Authentication to
the Appliance:</p>

<ul>
  <li>
    <p>A CentOS/RHEL 7.2 based MiQ Appliance</p>
  </li>
  <li>
    <p>Windows Server 2008 R2 or later with configured AD DC and DNS
installed locally on the DC</p>
  </li>
</ul>

<h2 id="set-up-and-configure-an-ipa-server-for-ad-trust-authentication">
<a class="anchor" href="#set-up-and-configure-an-ipa-server-for-ad-trust-authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set up and configure an IPA server for AD Trust Authentication</h2>

<ul>
  <li>Configure an IPA Server based on FreeIPA 3.3.3 or later</li>
</ul>

<p>Instructions for setting up and configuring cross-realm trust between an
IPA domain and an AD (Active Directory) domain can be found at
<a href="http://www.freeipa.org/page/Active_Directory_trust_setup">freeipa.org Active Directory Trust
Setup</a></p>

<ul>
  <li>Add necessary user attributes to the SSSD configuration on the IPA
server</li>
</ul>

<p>The SSSD configuration file on the IPA Server must be updated to list
needed user attributes.</p>

<p>Add the following entry to the SSSD configuration file
/etc/sssd/sssd.conf</p>

<p><strong>Note</strong>: Starting with SSSD version 1.15.2, which will be available in
CentOS version 7.4, SSSD will provide the domain name as a user
attribute. The below examples show how to set <em>ldap_user_extra_attrs</em>
and <em>user_attributes</em> to take advantage of this new feature. If running
an appliance built with CentOS version prior to CentOS 7.4 do not
include <em>domainname</em> for these attributes.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>ifp]
user_attributes <span class="o">=</span> +mail, +givenname, +sn, +displayname, +domainname
</code></pre></div></div>

<p>and update <em>ldap_user_extra_attrs</em> to include <em>domainname</em> where
appropriate.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>domain/example.com]
ldap_user_extra_attrs <span class="o">=</span> mail, givenname, sn, displayname, domainname
</code></pre></div></div>

<ul>
  <li>DNS Configuration Significance</li>
</ul>

<p>Special care should be made when configuring DNS as improper DNS
configurations can result in poor performance and improper
functionality. For more details refer to the following documents:</p>

<ul>
  <li>
    <p><a href="http://www.freeipa.org/page/Active_Directory_trust_setup#DNS_configuration">freeipa.org Active Directory Trust Setup/DNS
configuration</a></p>
  </li>
  <li>
    <p><a href="http://www.freeipa.org/page/DNS">freeipa.org DNS</a></p>
  </li>
  <li>
    <p><a href="https://www.freeipa.org/page/Howto/DNSSEC">freeipa.org DNSSEC</a></p>
  </li>
</ul>

<h2 id="enable-the-miq-appliance-to-use-the-configued-ipa-server">
<a class="anchor" href="#enable-the-miq-appliance-to-use-the-configued-ipa-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable the MiQ Appliance to use the configued IPA server</h2>

<p>Use the Appliance Console to enable external authentication to the IPA
Server.</p>

<ol>
  <li>
    <p>Log in to console as <em>root</em></p>
  </li>
  <li>
    <p>Run <em>appliance_console</em></p>
  </li>
  <li>
    <p>Summary screen should show <strong>External Auth</strong> as <em>not configured</em>,
Press any key</p>
  </li>
  <li>
    <p>From the Advanced Setting menu, select the menu item <strong>Configure
External Authentication (httpd)</strong></p>
  </li>
  <li>
    <p>Enter the FQDN of the IPA Server, i.e. <em>ipaserver.test.company.com</em></p>
  </li>
  <li>
    <p>Enter the IPA Server domain, i.e. <em>test.company.com</em></p>
  </li>
  <li>
    <p>Enter the IPA Server realm, i.e. <em>TEST.COMPANY.COM</em></p>
  </li>
  <li>
    <p>Press enter to select the default IPA Server Principal, i.e. <em>admin</em></p>
  </li>
  <li>
    <p>Enter the Password of the IPA Server Principal</p>
  </li>
  <li>
    <p>Review details, and Enter <strong>y</strong> to proceed.</p>
  </li>
</ol>

<h2 id="configure-the-miq-appliance-to-use-external-authentication">
<a class="anchor" href="#configure-the-miq-appliance-to-use-external-authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure the MiQ appliance to use external authentication</h2>

<p>Log in to the MiQ appliance as admin, then in
<em>Settings→Configuration→Server→Authentication</em></p>

<ul>
  <li>
    <p>Set mode to External (httpd)</p>
  </li>
  <li>
    <p>Check: <em>Get User Groups from External Authentication (httpd)</em></p>
  </li>
  <li>
    <p><em>Optionally</em> Check: <em>Enable Single Signon</em></p>
  </li>
  <li>
    <p>Click Save.</p>
  </li>
</ul>

<p>The above steps need to be done on each UI and WebService enabled
appliance.</p>

<p>in <em>Settings→Configuration→Access Control</em></p>

<ul>
  <li>Make sure the user’s groups are created on the Appliance and
appropriate roles assigned to those groups.</li>
</ul>

<h2 id="create-groups-on-the-miq-appliance">
<a class="anchor" href="#create-groups-on-the-miq-appliance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create groups on the MiQ appliance</h2>

<p>The below steps need to be done on each UI and WebService enabled
appliance.</p>

<p>Log in to the MiQ appliance as admin, then in
<em>Settings→Configuration→Access Control→Groups→Configuration→Add a
new Group</em></p>

<ul>
  <li>
    <p>Check: <em>(Look Up LDAP Groups)</em></p>
  </li>
  <li>
    <p>Enter the AD user as the <em>User to Look Up</em> i.e.
<em>ipauser@ipaserver.test.company.com</em></p>
  </li>
  <li>
    <p>Click Retrieve.</p>
  </li>
  <li>
    <p>Choose a group from the <em>LDAP Groups for User</em> dropdown.</p>
  </li>
  <li>
    <p>Assign the appropriate roles to the group</p>
  </li>
  <li>
    <p>Click Add.</p>
  </li>
</ul>

<h2 id="use-ad-trust-authentication">
<a class="anchor" href="#use-ad-trust-authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use AD Trust Authentication</h2>

<p>Once the above is done, the user simply needs to specify their AD
Username and Password when:</p>

<ul>
  <li>
    <p>Logging into the Appliance Administrative UI</p>
  </li>
  <li>
    <p>Accessing the REST API</p>
  </li>
  <li>
    <p>Using the Self Service UI</p>
  </li>
  <li>
    <p>Using the Single Sign On (SSO) to access the MiQ appliance after
generating a Kerberos ticket by using kinit with AD credentials.</p>
  </li>
</ul>


      </div>
    </article>
  </div>
</div>

    </main>

    <footer class="site-footer">
  <div class="footer-row" id="footer_top">
    <div class="footer-group">
      <img class="footer-logo" src="/assets/images/manageiq-glyph-inverse.svg" alt="ManageIQ">
      <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

    </div>


    <ul class="contact_menu">
      <li>
        <a href="https://github.com/ManageIQ/">
          <i class="fa fa-github"></i>
          Github
        </a>
      </li>
      <li>
        <a href="https://gitter.im/ManageIQ/manageiq">
          <i class="fa fa-gitter">
            <svg viewBox="45 47 78 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 40.1 (33804) - http://www.bohemiancoding.com/sketch -->
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Artboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(45.000000, 47.000000)">
        <g id="icon-gitter" transform="translate(10.000000, 0.000000)">
            <rect id="Rectangle-path" x="0" y="0.5" width="8.25" height="61"></rect>
            <rect id="Rectangle-path" x="49.75" y="14.5" width="8.25" height="47"></rect>
            <rect id="Rectangle-path" x="16.5" y="14.5" width="8.25" height="80.25"></rect>
            <rect id="Rectangle-path" x="33.25" y="14.5" width="8.25" height="80.25"></rect>
        </g>
    </g>
</svg>

          </i>
          Gitter
        </a>
      </li>
      <li>
        <a href="http://talk.manageiq.org/">
          <i class="fa fa-comments"></i>
          Forum
        </a>
      </li>
    </ul>
  </div>

  <div class="footer-row" id="footer_bottom">
    <div class="footer-legal">
      <span class="copyright">
        &copy; 2020 ManageIQ.
      </span>
      <span>
        <a href="http://community.redhat.com/software/" target="_blank">
          Sponsored by Red Hat, Inc.
        </a>
      </span>
      <span>
        <a href="/logo/" class="footer-link">Logo</a>
      </span>
      <span>
        <a href="/security/" class="footer-link">Security</a>
      </span>
      <span>
        <a href="/legal/" class="footer-link">Legal &amp; Privacy</a>
      </span>
    </div>

    <div class="footer-social">
      <ul class="social_menu">
        <li>
          <a href="https://twitter.com/ManageIQ" class="social_link social_link-twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>

        <li>
          <a href="https://www.facebook.com/manageiq/" class="social_link social_link-facebook">
            <span class="social_link-icon">
              <i class="fa fa-facebook"></i>
            </span>
          </a>
        </li>

        <!--  -->
        <li>
          <a href="https://www.linkedin.com/company/manageiq" class="social_link social_link-linkedin">
            <span class="social_link-icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
        </li>

        <li>
          <a href="https://www.youtube.com/user/ManageIQVideo" class="social_link social_link-youtube">
            <span class="social_link-icon">
              <i class="fa fa-youtube"></i>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    <div id="lightbox">
  <header class="lightbox-header">
    <div class="lightbox-title"></div>
    <div class="lightbox-close">
      <span class="fa fa-times"></span>
    </div>
  </header>

  <div class="lightbox-image">
    <img src="" alt="">
  </div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="/assets/js/main.js" charset="utf-8"></script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58883457-1', 'auto');
  ga('send', 'pageview');

</script>
    
  </body>
</html>
