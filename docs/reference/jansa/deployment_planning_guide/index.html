<!DOCTYPE html>
<html>

  <head>
  <!DOCTYPE html>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ManageIQ</title>
  <meta name="description" content="">
  <meta property="og:image" content="http://manageiq.org/assets/images/logo/manageiq-logo-blue.png" />

  <link type="text/css" rel="stylesheet" href="/assets/main-8de063b063e781c83c3900f2fb42692885edeac0346d54e22467184ccc393942.css">
  <link rel="canonical" href="http://manageiq.org/docs/reference/latest/deployment_planning_guide/">
  <link rel="alternate" type="application/rss+xml" title="ManageIQ" href="http://manageiq.org/feed.xml">

  <link href="/assets/images/favicon.ico" rel="shortcut icon">
</head>


  <body>
    <header class="site-header">
  <a href="/" class="brand">
    <span class="brand-name">ManageIQ</span>
    <img class="brand-logo" src="/assets/images/manageiq-logo-inverse.svg" alt="ManageIQ Logo">
  </a>

  <div id="site_header-nav_toggle">
    <a href="#" class="off_canvas-show" data-behavior="off_canvas-toggle">
      <i class="fa fa-bars"></i>
    </a>
  </div>

  <div class="off_canvas">
    <header class="off_canvas-header">
      <a href="#" class="off_canvas-hide" data-behavior="off_canvas-toggle">
        <i class="fa fa-times"></i>
      </a>
    </header>

    <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

  </div>
</header>


    <main data-url="/docs/reference/jansa/deployment_planning_guide/index">
      <nav class="doc_tabs">
  <ul>
  <li>
    <a href="/docs/get-started/">Get Started</a>
  </li>
  <li class="active">
    <a href="/docs/reference/">User Reference</a>
  </li>
  <li>
    <a href="/docs/automation">
      Automation Book
    </a>
  </li>
  <li>
    <a href="/docs/api">
      API Docs
    </a>
  </li>
  <li>
    <a href="/docs/guides/README">Developer Guides</a>
  </li>
</ul>

    <div class="col-lg-4 col-md-4 col-sm-12 pull-right" style="margin-top: 10px">
        <script async src="https://cse.google.com/cse.js?cx=006042792541147862616:dfkijfebdts"></script>
         <div class="gcse-search"></div>
    </div>
</nav>

<script>
  window.onload = demo;
	function demo() {
	    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search Documentation")
	}
</script>

<div class="doc_container">
  <div class="doc_menu">
    
    

<div class="doc_menu-heading">
  Jansa
</div>

<ul class="menu menu-toplevel" id=ref_menu_jansa>


  <li class="menu-parent">
    
    <a href="#">
      Installation
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_aws/index.html">
      Amazon Web Services (AWS)
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_microsoft_azure/index.html">
      Microsoft Azure
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_google_compute_engine/index.html">
      Google Compute Engine
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_vmware_vsphere/index.html">
      VMware vSphere
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_red_hat_enterprise_linux_openstack_platform/index.html">
      Red Hat Enterprise OpenStack Platform
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_red_hat_virtualization/index.html">
      Red Hat Enterprise Virtualization
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/installing_on_scvmm/index.html">
      Microsoft System Center Virtual Machine Manager (SCVMM)
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Configuration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item active">
    <a href="/docs/reference/jansa/deployment_planning_guide/index.html">
      Deployment Planning Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/general_configuration/index.html">
      General Configuration
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/high_availability_guide/index.html">
      High Availability Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/appliance_hardening_guide/index.html">
      Appliance Hardening Guide
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Administration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/monitoring_alerts_and_reporting/index.html">
      Monitoring, Alerts, and Reporting
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/policies_and_profiles_guide/index.html">
      Policies and Profiles Guide
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/managing_infrastructure_and_inventory/index.html">
      Managing Infrastructure and Inventory
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/managing_providers/index.html">
      Managing Providers
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/provisioning_virtual_machines_and_hosts/index.html">
      Provisioning Virtual Machines and Hosts
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/scripting_actions/index.html">
      Scripting Actions in ManageIQ
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Authentication
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/active_directory.html">
      Active Directory
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/ipa_2fa.html">
      2-Factor-Authentication with IPA
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/ipa_ad_trust.html">
      IPA/AD Trust
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/ldap.html">
      LDAP
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/saml.html">
      SAML
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/auth/openid_connect.html">
      OpenID-Connect
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Integration
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/integration_with_aws_cloudformation_and_openstack_heat/index.html">
      AWS CloudFormation and OpenStack Heat
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/integration_with_servicenow/index.html">
      ServiceNow
    </a>
    
  </li>


      </ul>
    
  </li>


  <li class="menu-parent">
    
    <a href="#">
      Reference
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/rest_api/index.html">
      ManageIQ REST API
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/reference/jansa/methods_available_for_automation/index.html">
      Methods Available for Automation
    </a>
    
  </li>


      </ul>
    
  </li>

</ul>

    
  </div>
  <div class="doc_main">
    <article class="doc user_doc">
      

      <div class="doc-content">
        
        <div class="doc-versions">
          <span class="label">Versions: </span>
          
            <span>
              <a href="/docs/reference/latest/deployment_planning_guide/index.html">
                Latest
              </a>
            </span>
            
              <span class="separator">/</span>
            
          
            <span class="active" >
              <a href="/docs/reference/jansa/deployment_planning_guide/index.html">
                Jansa
              </a>
            </span>
            
          
        </div>
        
        <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#deployment-planning-guide">Deployment Planning Guide</a>
<ul>
<li class="toc-entry toc-h2"><a href="#introduction-to-manageiq">Introduction to ManageIQ</a>
<ul>
<li class="toc-entry toc-h3"><a href="#architecture">Architecture</a></li>
<li class="toc-entry toc-h3"><a href="#requirements">Requirements</a>
<ul>
<li class="toc-entry toc-h4"><a href="#virtual-hardware-requirements">Virtual Hardware Requirements</a></li>
<li class="toc-entry toc-h4"><a href="#database-requirements">Database Requirements</a></li>
<li class="toc-entry toc-h4"><a href="#browser-requirements">Browser Requirements</a></li>
<li class="toc-entry toc-h4"><a href="#additional-requirements">Additional Requirements</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#terminology">Terminology</a></li>
<li class="toc-entry toc-h3"><a href="#regions">Regions</a></li>
<li class="toc-entry toc-h3"><a href="#roles">Roles</a>
<ul>
<li class="toc-entry toc-h4"><a href="#appliance-types">Appliance Types</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#centralized-administration">Centralized Administration</a></li>
<li class="toc-entry toc-h3"><a href="#tenancy">Tenancy</a></li>
<li class="toc-entry toc-h3"><a href="#using-a-load-balancer">Using a Load Balancer</a>
<ul>
<li class="toc-entry toc-h4"><a href="#configuring-the-load-balancer">Configuring the Load Balancer</a></li>
<li class="toc-entry toc-h4"><a href="#configuring-worker-appliances-for-load-balancing">Configuring Worker Appliances for Load Balancing</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#database-configuration">Database Configuration</a>
<ul>
<li class="toc-entry toc-h4"><a href="#user-overrides">User Overrides</a></li>
<li class="toc-entry toc-h4"><a href="#reading-configuration-settings">Reading Configuration Settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#capacity-planning">Capacity Planning</a>
<ul>
<li class="toc-entry toc-h3"><a href="#capacity-and-utilization-collection">Capacity and Utilization Collection</a></li>
<li class="toc-entry toc-h3"><a href="#assigning-the-capacity-and-utilization-server-roles">Assigning the Capacity and Utilization Server Roles</a></li>
<li class="toc-entry toc-h3"><a href="#adding-database-credentials-for-data-collection">Adding Database Credentials for Data Collection</a></li>
<li class="toc-entry toc-h3"><a href="#data-collection-for-red-hat-virtualization">Data Collection for Red Hat Virtualization</a></li>
<li class="toc-entry toc-h3"><a href="#data-collection-for-red-hat-enterprise-linux-openstack-platform">Data Collection for Red Hat Enterprise Linux OpenStack Platform</a></li>
<li class="toc-entry toc-h3"><a href="#capacity-and-utilization-data-collected">Capacity and Utilization Data Collected</a>
<ul>
<li class="toc-entry toc-h4"><a href="#capacity-and-utilization-charts-for-hosts-clusters-and-virtual-machines">Capacity and Utilization Charts for Hosts, Clusters, and Virtual Machines</a></li>
<li class="toc-entry toc-h4"><a href="#capacity-and-utilization-charts-for-datastores">Capacity and Utilization Charts for Datastores</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#capacity-and-utilization-chart-features">Capacity and Utilization Chart Features</a>
<ul>
<li class="toc-entry toc-h4"><a href="#zooming-into-a-chart">Zooming into a Chart</a></li>
<li class="toc-entry toc-h4"><a href="#drilling-into-chart-data">Drilling into Chart Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#appendix">Appendix</a>
<ul>
<li class="toc-entry toc-h2"><a href="#example-postgresql-configuration-file">Example PostgreSQL Configuration File</a></li>
</ul>
</li>
</ul><h1 id="deployment-planning-guide">
<a class="anchor" href="#deployment-planning-guide" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deployment Planning Guide</h1>

<h2 id="introduction-to-manageiq">
<a class="anchor" href="#introduction-to-manageiq" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction to ManageIQ</h2>

<p>ManageIQ delivers the insight, control, and automation that
enterprises need to address the challenges of managing virtual
environments. This technology enables enterprises with existing virtual
infrastructures to improve visibility and control, and those starting
virtualization deployments to build and operate a well-managed virtual
infrastructure.</p>

<p>ManageIQ provides the following feature sets:</p>

<ul>
  <li>
    <p>Insight: Discovery, Monitoring, Utilization, Performance, Reporting,
Analytic, Chargeback, and Trending.</p>
  </li>
  <li>
    <p>Control: Security, Compliance, Alerting, and Policy-Based Resource,
and Configuration Enforcement.</p>
  </li>
  <li>
    <p>Automate: IT Process, Task and Event, Provisioning, and Workload
Management and Orchestration.</p>
  </li>
  <li>
    <p>Integrate: Systems Management, Tools and Processes, Event Consoles,
Configuration Management Database (CMDB), Role-based Administration
(RBA), and Web Services.</p>
  </li>
</ul>

<h3 id="architecture">
<a class="anchor" href="#architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Architecture</h3>

<p>The diagram below describes the capabilities of ManageIQ. Its
features are designed to work together to provide robust management and
maintenance of your virtual infrastructure. <img src="../images/1845.png" alt="1845"></p>

<p>The architecture comprises the following components:</p>

<ul>
  <li>
    <p>The ManageIQ appliance (appliance) which is supplied as a
secure, high-performance, preconfigured virtual machine. It provides
support for HTTPS communications.</p>
  </li>
  <li>
    <p>The ManageIQ Server (Server) resides on the appliance. It is
the software layer that communicates between the SmartProxy and the
Virtual Management Database. It includes support for HTTPS
communications.</p>
  </li>
  <li>
    <p>The Virtual Management Database (VMDB) resides either on the
appliance or another computer accessible to the appliance. It is the
definitive source of intelligence collected about your Virtual
Infrastructure. It also holds status information regarding appliance
tasks.</p>
  </li>
  <li>
    <p>The ManageIQ Console (Console) is the Web interface used to
view and control the Server and appliance. It is consumed through
Web 2.0 mash-ups and web services (WS Management) interfaces.</p>
  </li>
  <li>
    <p>The SmartProxy can reside on the appliance or on an ESX Server. If
not embedded in the Server, the SmartProxy can be deployed from the
appliance. A SmartProxy agent must configured in each storage
location, and must be visible to the appliance. The SmartProxy acts
on behalf of the appliance communicating with it over HTTPS on
standard port 443.</p>
  </li>
</ul>

<h3 id="requirements">
<a class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h3>

<p>To use ManageIQ, certain virtual hardware, database, and browser
requirements must be met in your environment.</p>

<h4 id="virtual-hardware-requirements">
<a class="anchor" href="#virtual-hardware-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Virtual Hardware Requirements</h4>

<p>The ManageIQ appliance requires the following virtual hardware at
minimum:</p>

<ul>
  <li>
    <p>4 VCPUs</p>
  </li>
  <li>
    <p>12 GB RAM</p>
  </li>
  <li>
    <p>44 GB HDD + optional database disk</p>
  </li>
</ul>

<h4 id="database-requirements">
<a class="anchor" href="#database-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Database Requirements</h4>

<p>Red Hat recommends allocating the virtual machine disk fully at the time
of creation. Three main factors affect the size of your database over
time:</p>

<ul>
  <li>
    <p>Virtual Machine Count: the most important factor in the calculation
of virtual machine database (VMDB) size over time.</p>
  </li>
  <li>
    <p>Host Count: the number of hosts associated with the provider.</p>
  </li>
  <li>
    <p>Storage Count: the number of individual storage elements as seen
from the perspective of the provider or host. It is not the total
number of virtual disks for all virtual machines.</p>
  </li>
</ul>

<p>Use the following table as a guideline to calculate minimum requirements
for your database:</p>

<p><img src="../images/5780.png" alt="5780"></p>

<div class="note">

When enabling capacity and utilization for metrics gathering over a
period of time, it is recommended that the VMDB size scale accordingly.
Evaluate the number of instances in your provider inventory and storage
duration requirements to plan for increased VMDB sizing requirements.

</div>

<p>Use the following information to plan for your increased VMDB needs when
working with metrics gathering:</p>

<ul>
  <li>
    <p>Realtime metrics data are stored for 4 hours.</p>
  </li>
  <li>
    <p>Rollup metrics data are stored for 6 months.</p>
  </li>
</ul>

<p><strong>Example</strong>:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>Minute</strong></td>
      <td><strong>Hour</strong></td>
      <td><strong>Day</strong></td>
    </tr>
    <tr>
      <td><strong>OpenStack Provider Instance</strong></td>
      <td>
<strong>3</strong> Realtime Metrics</td>
      <td>
<strong>181</strong> (3 records * 60 minutes = 180 Realtime Metrics + 1 hourly Rollup Metric)</td>
      <td>
<strong>4,345</strong> (3 records * 60 minutes * 24 hours =4320 Realtime Metrics + 1 daily Rollup Metric)</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Metrics data storage times can be configured by editing the Advanced
Settings.</li>
</ul>

<h4 id="browser-requirements">
<a class="anchor" href="#browser-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Browser Requirements</h4>

<p>To use ManageIQ, the following browser requirements must be met:</p>

<ul>
  <li>
    <p>One of the following web browsers:</p>

    <ul>
      <li>
        <p>Google Chrome</p>
      </li>
      <li>
        <p>Mozilla Firefox</p>
      </li>
      <li>
        <p>Safari</p>
      </li>
      <li>
        <p>Internet Explorer 10 or higher</p>
      </li>
    </ul>
  </li>
</ul>

<h4 id="additional-requirements">
<a class="anchor" href="#additional-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Additional Requirements</h4>

<p>Additionally, the following must be configured to use ManageIQ:</p>

<ul>
  <li>
    <p>The ManageIQ appliance must already be installed and
activated in your enterprise environment.</p>
  </li>
  <li>
    <p>The SmartProxy must have visibility into the virtual machines and
cloud instances that you want to control.</p>
  </li>
  <li>
    <p>For more information, see
<a href="https://access.redhat.com/documentation/en-us/red_hat_cloudforms/4.2/html-single/general_configuration/#smartproxies">SmartProxies</a>
in the ManageIQ <em>General Configuration</em> guide.</p>
  </li>
</ul>

<h3 id="terminology">
<a class="anchor" href="#terminology" aria-hidden="true"><span class="octicon octicon-link"></span></a>Terminology</h3>

<p>The following terms are used throughout the documentation. Review them
before proceeding.</p>

<ul>
  <li>
    <p>Account Role
The level of access a user has to different parts and functions of
the ManageIQ console. There are a variety of Account Roles,
which can be assigned to users to restrict or allow access to parts
of the console and virtual infrastructure.</p>
  </li>
  <li>
    <p>Action
An execution that is performed after a condition is evaluated.</p>
  </li>
  <li>
    <p>Alert
ManageIQ alerts notify administrators and monitoring systems
of critical configuration changes and threshold limits in the
virtual environment. The notification can take the form of either an
email or an SNMP trap.</p>
  </li>
  <li>
    <p>Analysis Profile
A customized scan of hosts, virtual machines, or instances. You can
collect information from categories, files, event logs, and registry
entries.</p>
  </li>
  <li>
    <p>Cloud
A pool of on-demand and highly available computing resources. The
usage of these resources are scaled depending on the user
requirements and metered for cost.</p>
  </li>
  <li>
    <p>ManageIQ Appliance
A virtual machine where the virtual management database (VMDB) and
ManageIQ reside.</p>
  </li>
  <li>
    <p>ManageIQ Console
A web-based interface into the ManageIQ appliance.</p>
  </li>
  <li>
    <p>ManageIQ Role
A designation assigned to a ManageIQ server that defines what
a ManageIQ server can do.</p>
  </li>
  <li>
    <p>ManageIQ Server
The application that runs on the ManageIQ appliance and
communicates with the SmartProxy and the VMDB.</p>
  </li>
  <li>
    <p>Cluster
Hosts that are grouped together to provide high availability and
load balancing.</p>
  </li>
  <li>
    <p>Condition
A control policy test triggered by an event, which determines a
subsequent action.</p>
  </li>
  <li>
    <p>Discovery
Process run by the ManageIQ server which finds virtual
machine and cloud providers.</p>
  </li>
  <li>
    <p>Drift
The comparison of a virtual machine, instance, host, cluster to
itself at different points in time.</p>
  </li>
  <li>
    <p>Event
A trigger to check a condition.</p>
  </li>
  <li>
    <p>Event Monitor
Software on the ManageIQ appliance which monitors external
providers for events and sends them to the ManageIQ server.</p>
  </li>
  <li>
    <p>Host
A computer running a hypervisor, capable of hosting and monitoring
virtual machines. Supported hypervisors include RHV-H, VMware ESX
hosts, Windows Hyper-V hosts.</p>
  </li>
  <li>
    <p>Instance/Cloud Instance
A on-demand virtual machine based upon a predefined image and uses a
scalable set of hardware resources such as CPU, memory, networking
interfaces.</p>
  </li>
  <li>
    <p>Managed/Registered VM
A virtual machine that is connected to a host and exists in the
VMDB. Also, a template that is connected to a provider and exists in
the VMDB. Note that templates cannot be connected to a host.</p>
  </li>
  <li>
    <p>Managed/Unregistered VM
A virtual machine or template that resides on a repository or is no
longer connected to a provider or host and exists in the VMDB. A
virtual machine that was previously considered registered may become
unregistered if the virtual machine was removed from provider
inventory.</p>
  </li>
  <li>
    <p>Provider
An external management system that ManageIQ integrates
in order to collect data and perform operations.</p>
  </li>
  <li>
    <p>Policy
A combination of an event, a condition, and an action used to manage
a virtual machine.</p>
  </li>
  <li>
    <p>Policy Profile
A set of policies.</p>
  </li>
  <li>
    <p>Refresh
A process run by the ManageIQ server which checks for
relationships of the provider or host to other resources, such as
storage locations, repositories, virtual machines, or instances. It
also checks the power states of those resources.</p>
  </li>
  <li>
    <p>Regions
A region is the collection of zones that share the same database for
reporting and charting. A master region may be added to synchronize
multiple VMDBs into one VMDB for higher-level reporting, providing a
“single pane of glass” view.</p>
  </li>
  <li>
    <p>Resource
A host, provider, instance, virtual machine, repository, or
datastore.</p>
  </li>
  <li>
    <p>Resource Pool
A group of virtual machines across which CPU and memory resources
are allocated.</p>
  </li>
  <li>
    <p>Repository
A place on a datastore resource which contains virtual machines.</p>
  </li>
  <li>
    <p>SmartProxy
The SmartProxy is a software agent that acts on behalf of the
ManageIQ appliance to perform actions on hosts, providers,
storage and virtual machines.</p>
  </li>
</ul>

<p>-
    The SmartProxy can be configured to reside on the ManageIQ
    appliance or on an ESX server version. The SmartProxy can be
    deployed from the ManageIQ appliance, and provides visibility
    to the VMFS storage. Each storage location must have a SmartProxy
    with visibility to it. The SmartProxy acts on behalf of the
    ManageIQ appliance. If the SmartProxy is not embedded in the
    ManageIQ server, it communicates with the ManageIQ
    appliance over HTTPS on standard port 443.</p>

<ul>
  <li>
    <p>SmartState Analysis
Process run by the SmartProxy which collects the details of a
virtual machine or instance. Such details include accounts, drivers,
network information, hardware, and security patches. This process is
also run by the ManageIQ server on hosts and clusters. The
data is stored in the VMDB.</p>
  </li>
  <li>
    <p>SmartTags
Descriptors that allow you to create a customized, searchable index
for the resources in your clouds and infrastructure.</p>
  </li>
  <li>
    <p>Storage Location
A device, such as a VMware datastore, where digital information
resides that is connected to a resource.</p>
  </li>
  <li>
    <p>Tags
Descriptive terms defined by a ManageIQ user or the system
used to categorize a resource.</p>
  </li>
  <li>
    <p>Template
A template is a copy of a preconfigured virtual machine, designed to
capture installed software and software configurations, as well as
the hardware configuration, of the original virtual machine.</p>
  </li>
  <li>
    <p>Unmanaged Virtual Machine
Files discovered on a datastore that do not have a virtual machine
associated with them in the VMDB. These files may be registered to a
provider that the ManageIQ server does not have configuration
information on. Possible causes may be that the provider has not
been discovered or that the provider has been discovered, but no
security credentials have been provided.</p>
  </li>
  <li>
    <p>Virtual Machine
A software implementation of a system that functions similar to a
physical machine. Virtual machines utilize the hardware
infrastructure of a physical host, or a set of physical hosts, to
provide a scalable and on-demand method of system provisioning.</p>
  </li>
  <li>
    <p>Virtual Management Database (VMDB)
Database used by the ManageIQ appliance to store information
about your resources, users, and anything else required to manage
your virtual enterprise.</p>
  </li>
  <li>
    <p>Virtual Thumbnail
An image in the web interface representing a resource, such as a
provider or a virtual machine, showing the resource’s properties at
a glance. Each virtual thumbnail is divided into quadrants, which
provide information about the resource, such as its software and
power state.</p>
  </li>
  <li>
    <p>Worker Appliance
A ManageIQ appliance dedicated to a role other than
user interface or database.</p>
  </li>
  <li>
    <p>Zones
ManageIQ Infrastructure can be organized into zones to
configure failover and to isolate traffic. Zones can be created
based on your environment. Zones can be based on geographic
location, network location, or function. When first started, new
servers are put into the default zone.
 ## Planning</p>
  </li>
</ul>

<p>This guide provides some general guidelines to planning a deployment on
ManageIQ. This includes creating multiple regions containing
ManageIQ appliances, CPU sizing recommendations, database sizing
recommendations, and database configuration.</p>

<h3 id="regions">
<a class="anchor" href="#regions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Regions</h3>

<p>Regions are used for centralizing data which is collected from public
and private virtualization environments. A region is ultimately
represented as a single database for the VMDB. Regions are particularly
useful when multiple geographical locations need to be managed, as they
enable all the data collection to happen at each particular location and
avoid data collection traffic across slow links between networks.</p>

<p>When multiple regions are being used, each with their own unique ID, a
master region can be created to centralize the data of all the children
regions into a single master database. To do this, configure each child
region to replicate its data to the master region database (the
recommended region is 99, though any number up to three digits will
work). This parent and child region is a one-to-many relationship.</p>

<p>Regions can contain multiple zones, which in turn contain appliances.
Zones are used for further segregating network traffic along with
enabling failover configurations. Each appliance has the capability to
be configured for a number of specialized server roles. These roles are
limited to the zone containing the appliance they run on.</p>

<p>Only one failover type of each server role can run in a zone. If
multiple appliances have the same failover role, the extras are used as
backups that activate only if the primary appliance fails. Non-failover
server roles can run on multiple appliances simultaneously in a zone, so
resources can be adjusted according to the workload those roles are
responsible for.</p>

<p>The following diagram demonstrates an example of the multiple regions
working together in a ManageIQ environment.</p>

<p><img src="../images/7151.png" alt="7151"></p>

<p>The master appliance is located in Chicago and contains a master region
and a subregion that manages the worker appliances. The Mahwah
technology center contains a single subregion that manages two zones.
Likewise, the San Diego technology center contains a single subregion
managing a single zone.</p>

<div class="note">

  - Replicating a parent region to a higher-level parent is not
    supported.

  - Parent regions can be configured after the child regions are online.

</div>

<p>The following diagram provides a closer look at a region:</p>

<p><img src="../images/7150.png" alt="7150"></p>

<p>In this region, we have several ManageIQ appliances acting as UI
nodes and worker nodes. These worker nodes execute tasks on the
providers in your environment. The region also uses a region database
that reports to a master database on the main ManageIQ appliance.
All appliances can connect to the authentication services (Active
Directory, LDAP, Identity Management), outgoing mail (SMTP), and network
services (SNMP).</p>

<div class="note">

ManageIQ can be configured in a highly available setup. In
this case, all PostgreSQL instances must be running on a server that is
deployed from the ManageIQ appliance. High availability is
achieved by database replication between two or more database servers.

</div>

<h3 id="roles">
<a class="anchor" href="#roles" aria-hidden="true"><span class="octicon octicon-link"></span></a>Roles</h3>

<p>Server roles define what a server can do. Assigning different server
roles to appliances can allow them to focus on specific functions. When
planning a deployment, consider which roles to assign to each appliance.
Some server roles are enabled by default in ManageIQ. Many
server roles start worker processes.</p>

<p>Some roles are also dependent on other roles. For example, because the
ManageIQ user interface relies on the API for access, the
Web Services role must be enabled with the User Interface role for users
to log in to the appliance. See <a href="https://access.redhat.com/documentation/en-us/red_hat_cloudforms/4.7/html/general_configuration/configuration#server-roles">Server
Roles</a>
in <em>General Configuration</em> for details on each server role and its
function.</p>

<h4 id="appliance-types">
<a class="anchor" href="#appliance-types" aria-hidden="true"><span class="octicon octicon-link"></span></a>Appliance Types</h4>

<p>Depending on the needs of your environment, you may choose to separate
worker and database tasks between appliances. One example of this is to
implement a highly available configuration so that certain appliances
are running the PostgreSQL database and providing failover. For more
details about configuring high availability, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_cloudforms/4.7/html-single/high_availability_guide/"><em>High Availability
Guide</em></a>.</p>

<p>The following provides a summary of types of appliances:</p>

<table>
  <thead>
    <tr>
      <th>Appliance Type</th>
      <th>Database</th>
      <th>Workers</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>VMDB appliance</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Worker processes are running, and it also hosts its own database that other appliances can connect to.</td>
    </tr>
    <tr>
      <td>Non-database appliance</td>
      <td>No</td>
      <td>Yes</td>
      <td>Worker processes are running on the appliance, but it does not host a database. The appliance is connected to an external database.</td>
    </tr>
    <tr>
      <td>Dedicated-database appliance</td>
      <td>Yes</td>
      <td>No</td>
      <td>This appliance contains no worker processes, only a database for other appliances to connect to.</td>
    </tr>
    <tr>
      <td>Non-ManageIQ VM with database</td>
      <td>Yes</td>
      <td>No</td>
      <td>This appliance contains no worker processes, only a database. As this is not a ManageIQ appliance, you cannot run any ManageIQ <code class="language-plaintext highlighter-rouge">rake</code> tasks on it. This appliance must be migrated using a non-database appliance that is pointed at it, using it as a database.</td>
    </tr>
  </tbody>
</table>

<p>Appliance types</p>

<h3 id="centralized-administration">
<a class="anchor" href="#centralized-administration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Centralized Administration</h3>

<p>ManageIQ includes centralized administration capabilities, where
certain operations can be initiated from the global region and processed
and executed on remote regions. From the global region, you can also
access the user interfaces of virtual machines residing in remote
regions.</p>

<p>The following life cycle management operations can be initiated from the
global region using centralized administration:</p>

<ul>
  <li>
    <p>Virtual machine provisioning</p>
  </li>
  <li>
    <p>Virtual machine power operations</p>
  </li>
  <li>
    <p>Virtual machine retirement</p>
  </li>
  <li>
    <p>Virtual machine reconfiguration</p>
  </li>
  <li>
    <p>Service provisioning</p>
  </li>
  <li>
    <p>Service retirement</p>
  </li>
  <li>
    <p>Opening a virtual machine in the remote region</p>
  </li>
</ul>

<div class="note">

ManageIQ life cycle operations other than those listed
above are not supported. Centralized administration capabilities are not
supported from the Self Service user interface.

</div>

<p>With centralized administration, the remote_queue_put leverages a new
system-to-system REST API request to forward the original request to the
remote region. This request is put in the local queue in the remote
region, which is then delivered by a worker in the remote region as if
it was queued there all along. As a result, a ManageIQ
operator in the global region can be seen as provisioning on behalf of a
remote region.</p>

<p><img src="../images/centralized_admin.png" alt="Centralized Administration Diagram"></p>

<div class="note">

The operations initiated from the global region are subject to the
role-based access control (RBAC) rules on the remote region. The user in
the remote region which matches the logged-in user’s **user ID** will be
used to enforce RBAC in the target region. The operation will fail on
the remote system if the user does not have the required permissions.

</div>

<h3 id="tenancy">
<a class="anchor" href="#tenancy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tenancy</h3>

<p>ManageIQ supports multitenancy. Tenants can be totally separate
or they can be in a parent-child or peer relationship. Tenants in a
relationship can share or inherit a certain configuration. You can
subdivide and create child tenants and they, in turn, can have child
tenants, and so on. The ability to have multi-level (nested) tenants in
a hierarchy enables those at the bottom to inherit permissions from
those above. This configuration allows for granular user permissions to
be set on specific tenants.</p>

<p>A tenant can also contain a self-contained child tenant known as a
‘project’. A project cannot have a child tenant, but is useful for
allocating resources to a small group or team within a larger
organization.</p>

<div class="note">

If you do not add any additional tenants, all resources and user
accounts are contained in a single base tenant which is your
ManageIQ appliance itself. In ManageIQ, is
sometimes referred as 'tenant zero'.

</div>

<p><strong>Tenancy Account Roles.</strong></p>

<p>In ManageIQ, the following two account roles are
associated with tenancy:</p>

<ul>
  <li>
    <p>Tenant administrator</p>
  </li>
  <li>
    <p>Tenant quota administrator</p>
  </li>
</ul>

<div class="important">

Tenant administrator and tenant quota administrator roles are like
administrator and super administrator. These roles are not limited to
the tenant upon which they are acting and act across all tenants, and
therefore should be considered privileged users. These are not roles
inside a tenant.

</div>

<p><strong>Tenancy Models.</strong></p>

<p>The following two approaches exist for tenancy planning:</p>

<ul>
  <li>
    <p><strong>Tenantless</strong> - You can create a single large tenant, sometimes
referred as ‘tenant zero’, and perform all your operations in there
without any subdivision of resources or user accounts.</p>
  </li>
  <li>
    <p><strong>Enterprise model</strong> - A common scenario is to create a single
tenant, and then subdivide it based on the structures or departments
within your organization. Those departments are then able to further
subdivide their resources into distinct projects. With this model,
you have a single URL for user access, while still having the
ability to divide resources into nested hierarchical tenants.</p>
  </li>
</ul>

<p><strong>Tenancy Configuration.</strong></p>

<p>You can create and configure tenancy using the ManageIQ
user interface in the same place you set up users, groups and roles by
selecting <strong>Configuration</strong> from the settings menu, and then clicking on
the <strong>Access Control</strong> accordion.</p>

<p><strong>Tenancy in Automation.</strong></p>

<p>One of the features of tenancy is that each tenant can have its own
automate domain. Tenant-based domains can help in several use cases,
such as if you have:</p>

<ul>
  <li>
    <p>groups that need their own naming routines</p>
  </li>
  <li>
    <p>varying types of approval needs</p>
  </li>
  <li>
    <p>departments that use different end ticketing systems</p>
  </li>
  <li>
    <p>a customer who is a holding company or centralized IT organization
for managing different business units</p>
  </li>
</ul>

<p>Just like standard domains are nested, you can also add automate domains
that are nested at the tenant level.</p>

<p><strong>Tenancy Quota and Reporting.</strong></p>

<p>You can allocate and enforce quotas for the following attributes:</p>

<ul>
  <li>
    <p>Virtual CPUs</p>
  </li>
  <li>
    <p>Memory in GB</p>
  </li>
  <li>
    <p>Storage in GB</p>
  </li>
  <li>
    <p>Number of virtual machines</p>
  </li>
  <li>
    <p>Number of templates</p>
  </li>
</ul>

<p>You can generate or schedule a report for <strong>Tenant Quotas</strong> similar to
other reports.</p>

<div class="note">

Currently, in tenant quota reports you will see all of the tenants but
there is no nesting information available by parent and child tenants.

</div>

<p><strong>Example:.</strong></p>

<p>In the following example of a tenant quota report, <em>DevOps Teams</em> is a
parent tenant and <em>Team Alpha</em> and <em>Team Bravo</em> are child tenants.</p>

<p><img src="../images/tenant-quotas-report.png" alt="tenant quotas report"></p>

<ul>
  <li>
    <p>Total Quota: Total quota enforced per attribute for a tenant</p>
  </li>
  <li>
    <p>In Use: Amount of quota currently in use by tenants</p>
  </li>
  <li>
    <p>Allocated: Amount of quota given to all child tenants</p>
  </li>
  <li>
    <p>Available: <em>Total Quota</em> minus (-) <em>In Use</em> minus (-) <em>Allocated</em></p>
  </li>
</ul>

<p><strong>Tenancy Chargeback.</strong></p>

<p>You have the ability to do tenancy in chargeback where you are able to
assign rates and have a different rate for each tenant. You can make use
of the default rate or create your own set of rates depending on the
tenant. As well, there is an ability to create chargeback reports by
tenant.</p>

<p><strong>Tenancy Service Catalogs.</strong></p>

<p>Similar to automate domains, you can have service catalogs at each level
of tenancy. Once you add a service catalog at a particular level of
tenancy, it is visible to that tenant and its children (unless you use
tagging to exclude).</p>

<p><strong>Tenancy Providers.</strong></p>

<p>Providers can be added at any level of tenancy. Once added, a provider
is visible to any child or lower tenants, making it possible to easily
separate resources that are owned or accessed by one group, and should
not be available to other tenants.</p>

<p><strong>Tenancy Relationships and Properties.</strong></p>

<p>The tenant summary page found in menu:Configuration[Access Control &gt;
Tenants &gt; <em>Tenant</em>] provides detailed information about the tenant and
its relationships including:</p>

<ul>
  <li>
    <p>Catalog items and bundles</p>
  </li>
  <li>
    <p>Automate domains</p>
  </li>
  <li>
    <p>Provider relationships</p>
  </li>
</ul>

<h3 id="using-a-load-balancer">
<a class="anchor" href="#using-a-load-balancer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using a Load Balancer</h3>

<p>Deploying multiple user interface worker appliances and placing them
behind a third-party load balancer allows for redundancy and improved
performance. This requires extra configuration in both the load balancer
and in the ManageIQ user interface worker appliances.</p>

<h4 id="configuring-the-load-balancer">
<a class="anchor" href="#configuring-the-load-balancer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuring the Load Balancer</h4>

<ul>
  <li>
    <p>Configure the load balancer to use sticky sessions. This ensures
that when a session is started, all requests for that session are
sent to the same worker appliance.</p>
  </li>
  <li>
    <p>Configure the load balancer to test for connectivity using the
ManageIQ ping response page:
<code class="language-plaintext highlighter-rouge">https://appliance_name/ping</code>. The expected reply from the appliance
is the text string <em>pong</em>. Using this URL is preferable to the
appliance login URL as it does not establish a connection to the
database.</p>
  </li>
</ul>

<h4 id="configuring-worker-appliances-for-load-balancing">
<a class="anchor" href="#configuring-worker-appliances-for-load-balancing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuring Worker Appliances for Load Balancing</h4>

<p>When using a load balancer, configure appliances that have the <strong>User
Interface</strong> role enabled to store session data in the database. As a
result, the user does not need to re-login if the load balancer
redirects them to an alternative server in the case the original user
interface worker is unresponsive.</p>

<p>On each appliance, configure the session data storage location using the
<code class="language-plaintext highlighter-rouge">session_store</code> parameter within the advanced settings page in the
ManageIQ user interface:</p>

<ol>
  <li>
    <p>Click <img src="../images/config-gear.png" alt="config gear"> (<strong>Configuration</strong>).</p>
  </li>
  <li>
    <p>Click the <strong>Advanced</strong> tab.</p>
  </li>
  <li>
    <p>Change the <code class="language-plaintext highlighter-rouge">session_store</code> parameter to <code class="language-plaintext highlighter-rouge">sql</code> in the following line
(the default parameter is <code class="language-plaintext highlighter-rouge">cache</code>):</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>:server:
...
 :session_store: sql
</code></pre></div>    </div>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>
  </li>
</ol>

<div class="important">

Configure the `session_store` parameter to point to `sql` on each user
interface appliance behind the load balancer.

</div>

<h3 id="database-configuration">
<a class="anchor" href="#database-configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Database Configuration</h3>

<p>This section describes the ManageIQ PostgreSQL database
configuration. The below table provides information on each file: its
location, primary function, and notes regarding behavior or
recommendations.</p>

<table>
  <thead>
    <tr>
      <th>File</th>
      <th>Location</th>
      <th>Description</th>
      <th>Note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">postgresql.conf</code></td>
      <td>Data Directory</td>
      <td>Default server configuration</td>
      <td>Adds directive to include <code class="language-plaintext highlighter-rouge">/etc/manageiq/postgresql.conf.d</code> directory</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">postgresql.auto.conf</code></td>
      <td>Data Directory</td>
      <td>Contains configuration set by the <code class="language-plaintext highlighter-rouge">ALTER SYSTEM</code> command</td>
      <td><strong>Do not edit manually</strong></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">01_miq_overrides.conf</code></td>
      <td><code class="language-plaintext highlighter-rouge">/etc/manageiq/postgresql.conf.d</code></td>
      <td>Contains ManageIQ default overrides</td>
      <td>Overwritten on upgrades</td>
    </tr>
    <tr>
      <td>&lt;other files&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">/etc/manageiq/postgresql.conf.d</code></td>
      <td>Contains user overrides</td>
      <td>Takes precedence if alphabetically after <code class="language-plaintext highlighter-rouge">01_miq_overrides.conf</code>
</td>
    </tr>
  </tbody>
</table>

<p>Database files</p>

<h4 id="user-overrides">
<a class="anchor" href="#user-overrides" aria-hidden="true"><span class="octicon octicon-link"></span></a>User Overrides</h4>

<p>Store custom configurations, or user overrides, in
<code class="language-plaintext highlighter-rouge">/etc/manageiq/postgresql.conf.d</code>. Name the user override file so that
it follows <code class="language-plaintext highlighter-rouge">01_miq_overrides.conf</code> alphabetically. This ensures custom
configurations are not overwritten on ManageIQ upgrades.</p>

<p>The following file name example follows <code class="language-plaintext highlighter-rouge">01_miq_overrides.conf</code>
alphabetically in the <code class="language-plaintext highlighter-rouge">/etc/manageiq/postgresql.conf.d</code> directory:</p>

<p><strong>Example.</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test_miq_overrides.conf
</code></pre></div></div>

<h4 id="reading-configuration-settings">
<a class="anchor" href="#reading-configuration-settings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reading Configuration Settings</h4>

<p>Query the ManageIQ PostgreSQL database directly to read
configuration settings. See the <a href="https://www.postgresql.org/docs/9.5/index.html">PostgreSQL
Documentation</a> for more
information.</p>

<p>The following example queries the ManageIQ for current
value set for <code class="language-plaintext highlighter-rouge">max_wal_senders</code>:</p>

<p><strong>Example.</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`psql -d vmdb_production -c 'show max_wal_senders'
</code></pre></div></div>

<h2 id="capacity-planning">
<a class="anchor" href="#capacity-planning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity Planning</h2>

<h3 id="capacity-and-utilization-collection">
<a class="anchor" href="#capacity-and-utilization-collection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity and Utilization Collection</h3>

<p>ManageIQ server can collect and analyze capacity and utilization data from your virtual infrastructure. Use this data to understand the limitations of your current environment and plan for growth.</p>

<p>For some capacity and utilization data, ManageIQ calculates and shows trend lines in the charts. Trend lines are created by using linear regression, which is calculated by using the capacity and utilization data that is collected by ManageIQ during the interval you specify for the chart. The more data that you have the better the predictive value of the trend line.</p>

<p>There are three server roles that are associated with the collection and metric creation of capacity and utilization.</p>

<ul>
  <li>
    <p>The Capacity &amp; Utilization Coordinator role checks to see whether it is time to collect data, somewhat like a scheduler. If it is time, a job is queued for the Capacity &amp; Utilization Data Collector. The Coordinator role is required to complete capacity and utilization data collection. If more than one server in a specific zone has this role, only one is active at a time.</p>
  </li>
  <li>
    <p>The Capacity &amp; Utilization Data Collector performs the actual collection of capacity and utilization data. This role has a dedicated worker, and there can be more than one server with this role in a zone.</p>
  </li>
  <li>
    <p>The Capacity &amp; Utilization Data Processor processes all of the data that is collected, allowing ManageIQ to create charts. This role has a dedicated worker, and there can be more than one server with this role in a zone.</p>
  </li>
</ul>

<h3 id="assigning-the-capacity-and-utilization-server-roles">
<a class="anchor" href="#assigning-the-capacity-and-utilization-server-roles" aria-hidden="true"><span class="octicon octicon-link"></span></a>Assigning the Capacity and Utilization Server Roles</h3>

<ol>
  <li>
    <p>Click <strong>Configuration</strong>, then select the server to configure from
menu:Settings[Zone] in the accordion menu on the left.</p>
  </li>
  <li>
    <p>Navigate to the <strong>Server Roles</strong> list in the menu:Server[Server
Control] section. From there, set the required capacity and
utilization roles to <strong>ON</strong>, namely:</p>

    <ol>
      <li>
        <p><strong>Capacity &amp; Utilization Coordinator</strong></p>
      </li>
      <li>
        <p><strong>Capacity &amp; Utilization Data Collector</strong></p>
      </li>
      <li>
        <p><strong>Capacity &amp; Utilization Data Processor</strong></p>
      </li>
    </ol>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>
  </li>
</ol>

<p>Data collection is enabled immediately. However, the first collection
begins 5 minutes after the server is started, and every 10 minutes after
that. Therefore, the longest the collection takes after enabling the
Capacity &amp; Utilization Collector role is 10 minutes. The first
collection from a particular provider may take a few minutes since
ManageIQ is gathering data points going one month back in time.</p>

<div class="note">

In addition to setting the server role, you must also select which
clusters and datastores to collect data for. For more information, see the **General Configuration** guide. You must have super administrator rights to edit these settings.

</div>

<h3 id="adding-database-credentials-for-data-collection">
<a class="anchor" href="#adding-database-credentials-for-data-collection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding Database Credentials for Data Collection</h3>

<p>After you create the new user, add the user’s credentials to the settings for the provider.</p>

<ol>
  <li>
    <p>From menu: <strong>Compute &gt; Infrastructure &gt; Providers</strong>, select an
 infrastructure provider to update its settings.</p>
  </li>
  <li>
    <p>Click <img src="../images/1847.png" alt="1847"><strong>Configuration</strong>, and then
 <img src="../images/1851.png" alt="1851"><strong>Edit Selected Infrastructure Provider</strong>.</p>
  </li>
  <li>
    <p>In the <strong>Credentials</strong> area, click <strong>C &amp; U Database</strong>.</p>
  </li>
  <li>
    <p>Type in the credentials for the new database user you created.</p>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>
  </li>
  <li>
    <p>Restart the Capacity and Utilization Data Collector.</p>
  </li>
</ol>

<h3 id="data-collection-for-red-hat-virtualization">
<a class="anchor" href="#data-collection-for-red-hat-virtualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Collection for Red Hat Virtualization</h3>

<p>To collect capacity and utilization data for Red Hat Virtualization (RHV), you must add a user to the RHV-M history database for ManageIQ to use.</p>

<p>Perform this procedure on the PostgreSQL server where the history
database (ovirt_engine_history) is located. Usually, this is the RHV-M server.</p>

<ol>
  <li>
    <p>Using SSH, access the RHV-M database server as the root user:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ ssh root@example.postgres.server
</code></pre></div>    </div>
  </li>
  <li>
    <p>Switch to the postgres user:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # su - postgres
</code></pre></div>    </div>

    <div class="important">

 For RHV 4.2, the PostgreSQL database is delivered as a software
 collection in version 9.5 and must be enabled first. Therefore, to
 run the following psql commands, you need to enable the
 *rh-postgresql95* collection and load into the current shell prompt by using the source command:

 $ source /opt/rh/rh-postgresql95/enable

 </div>
  </li>
  <li>
    <p>Create the user for ManageIQ to be granted read-only access to the history database:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ psql -U postgres -c "CREATE ROLE cfme WITH LOGIN ENCRYPTED PASSWORD '[password]';" -d ovirt_engine_history
</code></pre></div>    </div>
  </li>
  <li>
    <p>Grant the newly created user permission to connect to the history
 database:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ psql -U postgres -c "GRANT CONNECT ON DATABASE ovirt_engine_history TO cfme;"
</code></pre></div>    </div>
  </li>
  <li>
    <p>Grant the newly created user usage of the public schema:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ psql -U postgres -c "GRANT USAGE ON SCHEMA public TO cfme;" ovirt_engine_history
</code></pre></div>    </div>
  </li>
  <li>
    <p>Generate the rest of the permissions that will be granted to the newly created user and save them to a file:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ psql -U postgres -c "SELECT 'GRANT SELECT ON ' || relname || ' TO cfme;' FROM pg_class JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE nspname = 'public' AND relkind IN ('r', 'v', 'S');" --pset=tuples_only=on  ovirt_engine_history &gt; grant.sql
</code></pre></div>    </div>
  </li>
  <li>
    <p>Use the file that you created in the previous step to grant permissions to the newly created user:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ psql -U postgres -f grant.sql ovirt_engine_history
</code></pre></div>    </div>
  </li>
  <li>
    <p>Remove the file that you used to grant permissions to the newly created user:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ rm grant.sql
</code></pre></div>    </div>
  </li>
  <li>
    <p>Exit to the RHV-M database server prompt:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ exit
</code></pre></div>    </div>
  </li>
  <li>
    <p>Update the server’s firewall to accept TCP communication on port 5432:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># firewall-cmd --add-port=5432/tcp --permanent
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enable external md5 authentication.</p>

    <ol>
      <li>
        <p>For RHV 4.0 and RHV 4.1, update the following line in
 <code class="language-plaintext highlighter-rouge">/var/lib/pgsql/data/pg_hba.conf</code>:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> host    all      all    0.0.0.0/0     md5
</code></pre></div>        </div>
      </li>
      <li>
        <p>For RHV 4.2, update the following line in
 <code class="language-plaintext highlighter-rouge">/var/opt/rh/rh-postgresql95/lib/pgsql/data/pg_hba.conf</code>:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> host    all      all    0.0.0.0/0     md5
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>
    <p>Enable PostgreSQL to listen for remote connections.</p>

    <ol>
      <li>
        <p>For RHV 4.0 and RHV 4.1, ensure the <code class="language-plaintext highlighter-rouge">listen_addresses</code> line in <code class="language-plaintext highlighter-rouge">/var/lib/pgsql/data/postgresql.conf</code> matches the following example:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> listen_addresses  =  '*'
</code></pre></div>        </div>
      </li>
      <li>
        <p>For RHV 4.2, ensure the <code class="language-plaintext highlighter-rouge">listen_addresses</code> line in
 <code class="language-plaintext highlighter-rouge">/var/opt/rh/rh-postgresql95/lib/pgsql/data/postgresql.conf</code> matches the following example:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> listen_addresses  =  '*'
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>
    <p>Reload the PostgreSQL configuration.</p>

    <ol>
      <li>
        <p>For RHV 4.0 and RHV 4.1:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # systemctl reload postgresql
</code></pre></div>        </div>
      </li>
      <li>
        <p>For RHV 4.2:</p>

        <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # systemctl reload rh-postgresql95-postgresql
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ol>

<h3 id="data-collection-for-red-hat-enterprise-linux-openstack-platform">
<a class="anchor" href="#data-collection-for-red-hat-enterprise-linux-openstack-platform" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Collection for Red Hat Enterprise Linux OpenStack Platform</h3>

<p>Before you can collect data from a Red Hat Enterprise Linux OpenStack Platform (RHEL-OSP) provider, you must install Ceilometer and configure it to accept queries from external systems.</p>

<p>These instructions require a Red Hat Enterprise Linux 6.4 @base
installation of RHEL-OSP and registration to a satellite that has access to both the <code class="language-plaintext highlighter-rouge">RHEL-OSP</code> and <code class="language-plaintext highlighter-rouge">RHEL Server Optional</code> channels. Perform all steps on your RHEL-OSP system.</p>

<ol>
  <li>
    <p>Add the required channels and update your system:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # rhn-channel --add -c rhel-x86_64-server-6-ost-3 -c rhel-x86_64-server-optional-6
 # yum update -y
 # reboot
</code></pre></div>    </div>
  </li>
  <li>
    <p>Install <code class="language-plaintext highlighter-rouge">Ceilometer</code>:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # yum install *ceilometer*
</code></pre></div>    </div>
  </li>
  <li>
    <p>Install and start the MongoDB store:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # yum install mongodb-server
 # sed -i '/--smallfiles/!s/OPTIONS=\"/OPTIONS=\"--smallfiles /' /etc/sysconfig/mongod
 # service mongod start
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create the following users and roles:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # SERVICE_TENANT=$(keystone tenant-list | grep services | awk '{print $2}')
 # ADMIN_ROLE=$(keystone role-list | grep ' admin ' | awk '{print $2}')
 # SERVICE_PASSWORD=servicepass
 # CEILOMETER_USER=$(keystone user-create --name=ceilometer \
 --pass="$SERVICE_PASSWORD" \
 --tenant_id $SERVICE_TENANT \
 --email=ceilometer@example.com | awk '/ id / {print $4}')
 # RESELLER_ROLE=$(keystone role-create --name=ResellerAdmin | awk '/ id / {print $4}')
 # ADMIN_ROLE=$(keystone role-list | awk '/ admin / {print $2}')
 # for role in $RESELLER_ROLE $ADMIN_ROLE ; do
 keystone user-role-add --tenant_id $SERVICE_TENANT \
 --user_id $CEILOMETER_USER --role_id $role
 done
</code></pre></div>    </div>
  </li>
  <li>
    <p>Configure the authtoken in <code class="language-plaintext highlighter-rouge">ceilometer.conf</code>:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken auth_host 127.0.0.1
 # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken auth_port 35357
 # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken auth_protocol http
 # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken admin_tenant_name services
 # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken admin_user ceilometer
 # openstack-config --set /etc/ceilometer/ceilometer.conf keystone_authtoken admin_password $SERVICE_PASSWORD
</code></pre></div>    </div>
  </li>
  <li>
    <p>Configure the user credentials in <code class="language-plaintext highlighter-rouge">ceilometer.conf</code>:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # openstack-config --set /etc/ceilometer/ceilometer.conf DEFAULT os_auth_url http://127.0.0.1:35357/v2.0
 # openstack-config --set /etc/ceilometer/ceilometer.conf DEFAULT os_tenant_name services
 # openstack-config --set /etc/ceilometer/ceilometer.conf DEFAULT os_password $SERVICE_PASSWORD
 # openstack-config --set /etc/ceilometer/ceilometer.conf DEFAULT os_username ceilometer
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start the Ceilometer services:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # for svc in compute central collector api ; do
   service openstack-ceilometer-$svc start
   done
</code></pre></div>    </div>
  </li>
  <li>
    <p>Register an endpoint with the service catalog. Replace
 <code class="language-plaintext highlighter-rouge">$EXTERNALIFACE</code> with the IP address of your external interface:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # keystone service-create --name=ceilometer \
 --type=metering --description="Ceilometer Service"
 # CEILOMETER_SERVICE=$(keystone service-list | awk '/ceilometer/ {print $2}')
 # keystone endpoint-create \
 --region RegionOne \
 --service_id $CEILOMETER_SERVICE \
 --publicurl "http://$EXTERNALIFACE:8777/" \
 --adminurl "http://$EXTERNALIFACE:8777/" \
 --internalurl "http://localhost:8777/"
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enable access to Ceilometer from external systems:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> # iptables -I INPUT -p tcp -m multiport --dports 8777 -m comment --comment "001 ceilometer incoming" -j ACCEPT
 # iptables save
</code></pre></div>    </div>
  </li>
  <li>
    <p>Confirm the status of OpenStack and the Ceilometer services:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># openstack-status
# for svc in compute central collector api ; do
  service openstack-ceilometer-$svc status
  done
</code></pre></div>    </div>
  </li>
  <li>
    <p>Verify that Ceilometer is working correctly by authenticating as a user with running instances, for example <code class="language-plaintext highlighter-rouge">admin</code>. Pipe the sample for the CPU meter to count lines, and confirm that the value changes according to the interval specified in <code class="language-plaintext highlighter-rouge">/etc/ceilometer/pipeline.yaml</code>. The default interval is 600 seconds.</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># . ~/keystonerc_admin
# ceilometer sample-list -m cpu |wc -l
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the configured OpenStack provider to ManageIQ. See After adding the provider, capacity, and utilization data for your instances populate in a few minutes.</p>
  </li>
</ol>

<h3 id="capacity-and-utilization-data-collected">
<a class="anchor" href="#capacity-and-utilization-data-collected" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity and Utilization Data Collected</h3>

<p>ManageIQ generates charts from the collected data that can be used to plan your hardware and virtual machine needs. Depending on the type of data, these charts can include lines for averages, maximums, minimums, and trends.</p>

<div class="note">

For reporting of daily capacity and utilization data, incomplete days (days with less than 24 hourly data points from midnight to midnight) that are at the beginning or end of the requested interval are excluded. Days with less than 24 hourly data points would be inaccurate and including them would skew trend lines. Therefore, at least one full day of hourly data from midnight to midnight is necessary for displaying the capacity and utilization charts under the menu: **Compute &gt; Infrastructure** tab.

</div>

<h4 id="capacity-and-utilization-charts-for-hosts-clusters-and-virtual-machines">
<a class="anchor" href="#capacity-and-utilization-charts-for-hosts-clusters-and-virtual-machines" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity and Utilization Charts for Hosts, Clusters, and Virtual Machines</h4>

<table>
  <thead>
    <tr>
      <th>Resource Type</th>
      <th>CPU Usage</th>
      <th>CPU States</th>
      <th>Disk I/O</th>
      <th>Memory Usage</th>
      <th>Network I/O</th>
      <th>Running VMS</th>
      <th>Running Hosts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Host</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>NA</td>
    </tr>
    <tr>
      <td>Cluster</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <td>Virtual Machine</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>NA</td>
      <td>NA</td>
    </tr>
  </tbody>
</table>

<p>Capacity and Utilization Charts for Hosts, Clusters, and Virtual
Machines</p>

<h4 id="capacity-and-utilization-charts-for-datastores">
<a class="anchor" href="#capacity-and-utilization-charts-for-datastores" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity and Utilization Charts for Datastores</h4>

<p>Charts that are created include:</p>

<table>
  <thead>
    <tr>
      <th>Space by VM Type</th>
      <th>Virtual Machines and Hosts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Used Space</td>
      <td>Number of VMs by Type</td>
    </tr>
    <tr>
      <td>Disk files Space</td>
      <td>Hosts</td>
    </tr>
    <tr>
      <td>Snapshot Files Space</td>
      <td>Virtual Machines</td>
    </tr>
    <tr>
      <td>Memory Files Space</td>
      <td> </td>
    </tr>
    <tr>
      <td>Non-VM Files</td>
      <td> </td>
    </tr>
    <tr>
      <td>Used Disk Space</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Capacity and Utilization Charts for Datastores</p>

<h3 id="capacity-and-utilization-chart-features">
<a class="anchor" href="#capacity-and-utilization-chart-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capacity and Utilization Chart Features</h3>

<p>Capacity and utilization charts for host, clusters, virtual machines, and datastore provides its own set of special features that include zooming in on a chart and shortcut menus.</p>

<h4 id="zooming-into-a-chart">
<a class="anchor" href="#zooming-into-a-chart" aria-hidden="true"><span class="octicon octicon-link"></span></a>Zooming into a Chart</h4>

<ol>
  <li>
    <p>Navigate to the chart you want to zoom. If you hover anywhere on the chart, two dashed lines appear to target a coordinate of the chart.</p>
  </li>
  <li>
    <p>Click <img src="../images/2251.png" alt="2251">(<strong>Click to zoom in</strong>) in the lower left corner of the chart to zoom into it.</p>
  </li>
  <li>
    <p>To go back to the regular view click <img src="../images/2252.png" alt="2252">(<strong>Click to zoom out</strong>) on the enlarged chart.</p>
  </li>
</ol>

<h4 id="drilling-into-chart-data">
<a class="anchor" href="#drilling-into-chart-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Drilling into Chart Data</h4>

<ol>
  <li>
    <p>Navigate to the chart you want to get more detail from.</p>
  </li>
  <li>
    <p>Hover over a data point to see the coordinates.</p>
  </li>
  <li>
    <p>Click a data point to open a shortcut menu for the chart. In this example, you can use the shortcut menu to go to the hourly chart or display the virtual machines that were running at the time the data was captured.</p>

    <ul>
      <li>
        <p>If you are viewing the <strong>CPU</strong>, <strong>Disk</strong>, <strong>Memory</strong>, or
<strong>Network</strong> charts, selecting from the <strong>Chart</strong> option will change all of the charts on the page to the new interval selected.</p>
      </li>
      <li>
        <p>If you are viewing the <strong>CPU</strong>, <strong>Disk</strong>, <strong>Memory</strong>, or
<strong>Network</strong> charts, selecting from the <strong>Display</strong> option will allow you to drill into the virtual machines or <strong>Hosts</strong> that were running at the time.</p>
      </li>
      <li>
        <p>If you are viewing the <strong>VM</strong> or <strong>Hosts</strong> chart, the
<strong>Display</strong> menu allows you to view running or stopped
virtual machines. The time of the data point will be displayed in addition to the virtual machines that apply. From here, click a virtual machine to view its details.</p>
      </li>
    </ul>
  </li>
</ol>

<h1 id="appendix">
<a class="anchor" href="#appendix" aria-hidden="true"><span class="octicon octicon-link"></span></a>Appendix</h1>

<h2 id="example-postgresql-configuration-file">
<a class="anchor" href="#example-postgresql-configuration-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example PostgreSQL Configuration File</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># -----------------------------
# PostgreSQL configuration file - MIQ Dedicated Appliance Configuration
# -----------------------------
#
# This file consists of lines of the form:
#
#   name = value
#
# (The "=" is optional.)  Whitespace may be used.  Comments are introduced with
# "#" anywhere on a line.  The complete list of parameter names and allowed
# values can be found in the PostgreSQL documentation.
#
# The commented-out settings shown in this file represent the default values.
# Re-commenting a setting is NOT sufficient to revert it to the default value;
# you need to reload the server.
#
# This file is read on server startup and when the server receives a SIGHUP
# signal.  If you edit the file on a running system, you have to SIGHUP the
# server for the changes to take effect, or use "pg_ctl reload".  Some
# parameters, which are marked below, require a server shutdown and restart to
# take effect.
#
# Any parameter can also be given as a command-line option to the server, e.g.,
# "postgres -c log_connections=on".  Some parameters can be changed at run time
# with the "SET" SQL command.
#
# Memory units:  kB = kilobytes        Time units:  ms  = milliseconds
#                MB = megabytes                     s   = seconds
#                GB = gigabytes                     min = minutes
#                                                   h   = hours
#                                                   d   = days


#------------------------------------------------------------------------------
# FILE LOCATIONS
#------------------------------------------------------------------------------

# The default values of these variables are driven from the -D command-line
# option or PGDATA environment variable, represented here as ConfigDir.

#data_directory = 'ConfigDir'       # use data in another directory
                    # (change requires restart)
#hba_file = 'ConfigDir/pg_hba.conf' # host-based authentication file
                    # (change requires restart)
#ident_file = 'ConfigDir/pg_ident.conf' # ident configuration file
                    # (change requires restart)

# If external_pid_file is not explicitly set, no extra PID file is written.
#external_pid_file = '(none)'       # write an extra PID file
                    # (change requires restart)


#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------

# - Connection Settings -

listen_addresses = '10.132.50.128'  # MIQ Value;
#listen_addresses = 'localhost'     # what IP address(es) to listen on;
                    # comma-separated list of addresses;
                    # defaults to 'localhost', '*' = all
                    # (change requires restart)
#port = 5432                # (change requires restart)
max_connections = 1600          # MIQ Value increased
#max_connections = 100          # (change requires restart) Note:  Increasing max_connections costs ~400 bytes of shared memory per connection slot, plus lock space (see max_locks_per_transaction).
#superuser_reserved_connections = 3 # (change requires restart)
#unix_socket_directory = ''     # (change requires restart)
#unix_socket_group = ''         # (change requires restart)
#unix_socket_permissions = 0777     # begin with 0 to use octal notation
                    # (change requires restart)
#bonjour = off              # advertise server via Bonjour
                    # (change requires restart)
#bonjour_name = ''          # defaults to the computer name
                    # (change requires restart)

# - Security and Authentication -

#authentication_timeout = 1min      # 1s-600s
#ssl = off              # (change requires restart)
#ssl_ciphers = 'ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH'  # allowed SSL ciphers
                    # (change requires restart)
#ssl_renegotiation_limit = 512MB    # amount of data between renegotiations
#password_encryption = on
#db_user_namespace = off

# Kerberos and GSSAPI
#krb_server_keyfile = ''
#krb_srvname = 'postgres'       # (Kerberos only)
#krb_caseins_users = off

# - TCP Keepalives -
# see "man 7 tcp" for details

tcp_keepalives_idle = 3         # MIQ Value;
#tcp_keepalives_idle = 0        # TCP_KEEPIDLE, in seconds;
                    # 0 selects the system default
tcp_keepalives_interval = 75        # MIQ Value;
#tcp_keepalives_interval = 0        # TCP_KEEPINTVL, in seconds;
                    # 0 selects the system default
tcp_keepalives_count = 9        # MIQ Value;
#tcp_keepalives_count = 0       # TCP_KEEPCNT;
                    # 0 selects the system default


#------------------------------------------------------------------------------
# RESOURCE USAGE (except WAL)
#------------------------------------------------------------------------------

# - Memory -

#shared_buffers = 128MB         # MIQ Value SHARED CONFIGURATION
shared_buffers = 4GB            # MIQ Value DEDICATED CONFIGURATION increased
#shared_buffers = 32MB          # min 128kB
                    # (change requires restart)
#temp_buffers = 8MB         # min 800kB
#max_prepared_transactions = 0      # zero disables the feature
                    # (change requires restart)
# Note:  Increasing max_prepared_transactions costs ~600 bytes of shared memory
# per transaction slot, plus lock space (see max_locks_per_transaction).
# It is not advisable to set max_prepared_transactions nonzero unless you
# actively intend to use prepared transactions.
#work_mem = 1MB             # min 64kB
#maintenance_work_mem = 16MB        # min 1MB
#max_stack_depth = 2MB          # min 100kB

# - Kernel Resource Usage -

#max_files_per_process = 1000       # min 25
                    # (change requires restart)
#shared_preload_libraries = ''      # (change requires restart)

# - Cost-Based Vacuum Delay -

#vacuum_cost_delay = 0ms        # 0-100 milliseconds
#vacuum_cost_page_hit = 1       # 0-10000 credits
#vacuum_cost_page_miss = 10     # 0-10000 credits
#vacuum_cost_page_dirty = 20        # 0-10000 credits
#vacuum_cost_limit = 200        # 1-10000 credits

# - Background Writer -

#bgwriter_delay = 200ms         # 10-10000ms between rounds
#bgwriter_lru_maxpages = 100        # 0-1000 max buffers written/round
#bgwriter_lru_multiplier = 2.0      # 0-10.0 multipler on buffers scanned/round

# - Asynchronous Behavior -

#effective_io_concurrency = 1       # 1-1000. 0 disables prefetching


#------------------------------------------------------------------------------
# WRITE AHEAD LOG
#------------------------------------------------------------------------------

# - Settings -

#wal_level = minimal            # minimal, archive, or hot_standby
                    # (change requires restart)
#fsync = on             # turns forced synchronization on or off
#synchronous_commit = on        # synchronization level; on, off, or local
#wal_sync_method = fsync        # the default is the first option
                    # supported by the operating system:
                    #   open_datasync
                    #   fdatasync (default on Linux)
                    #   fsync
                    #   fsync_writethrough
                    #   open_sync
#full_page_writes = on          # recover from partial page writes
wal_buffers = 16MB          # MIQ Value;
#wal_buffers = -1           # min 32kB, -1 sets based on shared_buffers
                    # (change requires restart)
#wal_writer_delay = 200ms       # 1-10000 milliseconds

#commit_delay = 0           # range 0-100000, in microseconds
#commit_siblings = 5            # range 1-1000

# - Checkpoints -

checkpoint_segments = 15        # MIQ Value;
#checkpoint_segments = 3        # in logfile segments, min 1, 16MB each
#checkpoint_timeout = 5min      # range 30s-1h
checkpoint_completion_target = 0.9  # MIQ Value;
#checkpoint_completion_target = 0.5 # checkpoint target duration, 0.0 - 1.0
#checkpoint_warning = 30s       # 0 disables

# - Archiving -

#archive_mode = off     # allows archiving to be done
                # (change requires restart)
#archive_command = ''       # command to use to archive a logfile segment
#archive_timeout = 0        # force a logfile segment switch after this
                # number of seconds; 0 disables


#------------------------------------------------------------------------------
# REPLICATION
#------------------------------------------------------------------------------

# - Master Server -

# These settings are ignored on a standby server

#max_wal_senders = 0        # max number of walsender processes
                # (change requires restart)
#wal_sender_delay = 1s      # walsender cycle time, 1-10000 milliseconds
#wal_keep_segments = 0      # in logfile segments, 16MB each; 0 disables
#vacuum_defer_cleanup_age = 0   # number of xacts by which cleanup is delayed
#replication_timeout = 60s  # in milliseconds; 0 disables
#synchronous_standby_names = '' # standby servers that provide sync rep
                # comma-separated list of application_name
                # from standby(s); '*' = all

# - Standby Servers -

# These settings are ignored on a master server

#hot_standby = off          # "on" allows queries during recovery
                    # (change requires restart)
#max_standby_archive_delay = 30s    # max delay before canceling queries
                    # when reading WAL from archive;
                    # -1 allows indefinite delay
#max_standby_streaming_delay = 30s  # max delay before canceling queries
                    # when reading streaming WAL;
                    # -1 allows indefinite delay
#wal_receiver_status_interval = 10s # send replies at least this often
                    # 0 disables
#hot_standby_feedback = off     # send info from standby to prevent
                    # query conflicts


#------------------------------------------------------------------------------
# QUERY TUNING
#------------------------------------------------------------------------------

# - Planner Method Configuration -

#enable_bitmapscan = on
#enable_hashagg = on
#enable_hashjoin = on
#enable_indexscan = on
#enable_material = on
#enable_mergejoin = on
#enable_nestloop = on
#enable_seqscan = on
#enable_sort = on
#enable_tidscan = on

# - Planner Cost Constants -

#seq_page_cost = 1.0            # measured on an arbitrary scale
#random_page_cost = 4.0         # same scale as above
#cpu_tuple_cost = 0.01          # same scale as above
#cpu_index_tuple_cost = 0.005       # same scale as above
#cpu_operator_cost = 0.0025     # same scale as above
#effective_cache_size = 128MB

# - Genetic Query Optimizer -

#geqo = on
#geqo_threshold = 12
#geqo_effort = 5            # range 1-10
#geqo_pool_size = 0         # selects default based on effort
#geqo_generations = 0           # selects default based on effort
#geqo_selection_bias = 2.0      # range 1.5-2.0
#geqo_seed = 0.0            # range 0.0-1.0

# - Other Planner Options -

#default_statistics_target = 100    # range 1-10000
#constraint_exclusion = partition   # on, off, or partition
#cursor_tuple_fraction = 0.1        # range 0.0-1.0
#from_collapse_limit = 8
#join_collapse_limit = 8        # 1 disables collapsing of explicit
                    # JOIN clauses


#------------------------------------------------------------------------------
# ERROR REPORTING AND LOGGING
#------------------------------------------------------------------------------

# - Where to Log -


log_destination = 'stderr'      # Valid values are combinations of
                    # stderr, csvlog, syslog, and eventlog,
                    # depending on platform.  csvlog
                    # requires logging_collector to be on.

# This is used when logging to stderr:
logging_collector = on      # Enable capturing of stderr and csvlog
                    # into log files. Required to be on for
                    # csvlogs.
                    # (change requires restart)

# These are only used if logging_collector is on:
log_directory = '/www/postgres/log' # Customer specific setting
#log_directory = 'pg_log'       # directory where log files are written,
                    # can be absolute or relative to PGDATA
log_filename = 'postgresql-%Y-%m-%d.log'        # log file name pattern,
                    # can include strftime() escapes
log_file_mode = 0644                    # creation mode for log files,
                    # begin with 0 to use octal notation
log_truncate_on_rotation = on           # If on, an existing log file with the
                    # same name as the new log file will be
                    # truncated rather than appended to.
                    # But such truncation only occurs on
                    # time-driven rotation, not on restarts
                    # or size-driven rotation.  Default is
                    # off, meaning append to existing files
                    # in all cases.
log_rotation_age = 1d                   # Automatic rotation of logfiles will
                    # happen after that time.  0 disables.
log_rotation_size = 0                   # Automatic rotation of logfiles will
                    # happen after that much log output.
                    # 0 disables.

# These are relevant when logging to syslog:
#syslog_facility = 'LOCAL0'
#syslog_ident = 'postgres'

#silent_mode = off          # Run server silently.
                    # DO NOT USE without syslog or
                    # logging_collector
                    # (change requires restart)


# - When to Log -

#client_min_messages = notice       # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   log
                    #   notice
                    #   warning
                    #   error

#log_min_messages = warning     # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   info
                    #   notice
                    #   warning
                    #   error
                    #   log
                    #   fatal
                    #   panic

#log_min_error_statement = error    # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   info
                    #   notice
                    #   warning
                    #   error
                    #   log
                    #   fatal
                    #   panic (effectively off)

log_min_duration_statement = 5000   # MIQ Value- ANY statement &gt; 5 seconds
#log_min_duration_statement = -1    # -1 is disabled, 0 logs all statements
                    # and their durations, &gt; 0 logs only
                    # statements running at least this number
                    # of milliseconds


# - What to Log -

#debug_print_parse = off
#debug_print_rewritten = off
#debug_print_plan = off
#debug_pretty_print = on
#log_checkpoints = off
#log_connections = off
#log_disconnections = off
#log_duration = off
#log_error_verbosity = default      # terse, default, or verbose messages
#log_hostname = off
log_line_prefix = '%t:%r:%c:%u@%d:[%p]:'    # MIQ Value;
#log_line_prefix = ''           # special values:
                    #   %a = application name
                    #   %u = user name
                    #   %d = database name
                    #   %r = remote host and port
                    #   %h = remote host
                    #   %p = process ID
                    #   %t = timestamp without milliseconds
                    #   %m = timestamp with milliseconds
                    #   %i = command tag
                    #   %e = SQL state
                    #   %c = session ID
                    #   %l = session line number
                    #   %s = session start timestamp
                    #   %v = virtual transaction ID
                    #   %x = transaction ID (0 if none)
                    #   %q = stop here in non-session
                    #        processes
                    #   %% = '%'
                    # e.g. '&lt;%u%%%d&gt; '
log_lock_waits = on         # MIQ Value - used to track possible deadlock issues
#log_lock_waits = off           # log lock waits &gt;= deadlock_timeout
#log_statement = 'none'         # none, ddl, mod, all
#log_temp_files = -1            # log temporary files equal or larger
                    # than the specified size in kilobytes;
                    # -1 disables, 0 logs all temp files
#log_timezone = '(defaults to server environment setting)'


#------------------------------------------------------------------------------
# RUNTIME STATISTICS
#------------------------------------------------------------------------------

# - Query/Index Statistics Collector -

#track_activities = on
track_counts = on           # MIQ Value;
#track_counts = on
#track_functions = none         # none, pl, all
#track_activity_query_size = 1024   # (change requires restart)
#update_process_title = on
#stats_temp_directory = 'pg_stat_tmp'


# - Statistics Monitoring -

#log_parser_stats = off
#log_planner_stats = off
#log_executor_stats = off
#log_statement_stats = off


#------------------------------------------------------------------------------
# AUTOVACUUM PARAMETERS
#------------------------------------------------------------------------------

autovacuum = on             # MIQ Value;
#autovacuum = on            # Enable autovacuum subprocess?  'on'
                    # requires track_counts to also be on.
log_autovacuum_min_duration = 0     # MIQ Value;
#log_autovacuum_min_duration = -1   # -1 disables, 0 logs all actions and
                    # their durations, &gt; 0 logs only
                    # actions running at least this number
                    # of milliseconds.
autovacuum_max_workers = 1      # max number of autovacuum subprocesses
                    # (change requires restart)
autovacuum_naptime = 30min      # MIQ Value;
#autovacuum_naptime = 1min      # time between autovacuum runs
autovacuum_vacuum_threshold = 500   # MIQ Value;
#autovacuum_vacuum_threshold = 50   # min number of row updates before
                    # vacuum
autovacuum_analyze_threshold = 500  # MIQ Value;
#autovacuum_analyze_threshold = 50  # min number of row updates before
                    # analyze
autovacuum_vacuum_scale_factor = 0.05   # MIQ Value;
#autovacuum_vacuum_scale_factor = 0.2   # fraction of table size before vacuum
#autovacuum_analyze_scale_factor = 0.1  # fraction of table size before analyze
#autovacuum_freeze_max_age = 200000000  # maximum XID age before forced vacuum
                    # (change requires restart)
#autovacuum_vacuum_cost_delay = 20ms    # default vacuum cost delay for
                    # autovacuum, in milliseconds;
                    # -1 means use vacuum_cost_delay
#autovacuum_vacuum_cost_limit = -1  # default vacuum cost limit for
                    # autovacuum, -1 means use
                    # vacuum_cost_limit


#------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#------------------------------------------------------------------------------

# - Statement Behavior -

#search_path = '"$user",public'     # schema names
#default_tablespace = ''        # a tablespace name, '' uses the default
#temp_tablespaces = ''          # a list of tablespace names, '' uses
                    # only default tablespace
#check_function_bodies = on
#default_transaction_isolation = 'read committed'
#default_transaction_read_only = off
#default_transaction_deferrable = off
#session_replication_role = 'origin'
#statement_timeout = 0          # in milliseconds, 0 is disabled
#statement_timeout = 43200000           # MIQ statment timeout of 12 hours as a default
#vacuum_freeze_min_age = 50000000
#vacuum_freeze_table_age = 150000000
#bytea_output = 'hex'           # hex, escape
#xmlbinary = 'base64'
#xmloption = 'content'

# - Locale and Formatting -

datestyle = 'iso, mdy'
#intervalstyle = 'postgres'
#timezone = '(defaults to server environment setting)'
#timezone_abbreviations = 'Default'     # Select the set of available time zone
                    # abbreviations.  Currently, there are
                    #   Default
                    #   Australia
                    #   India
                    # You can create your own file in
                    # share/timezonesets/.
#extra_float_digits = 0         # min -15, max 3
#client_encoding = sql_ascii        # actually, defaults to database
                    # encoding

# These settings are initialized by initdb, but they can be changed.
lc_messages = 'en_US.UTF-8'         # locale for system error message
                    # strings
lc_monetary = 'en_US.UTF-8'         # locale for monetary formatting
lc_numeric = 'en_US.UTF-8'          # locale for number formatting
lc_time = 'en_US.UTF-8'             # locale for time formatting

# default configuration for text search
default_text_search_config = 'pg_catalog.english'

# - Other Defaults -

#dynamic_library_path = '$libdir'
#local_preload_libraries = ''


#------------------------------------------------------------------------------
# LOCK MANAGEMENT
#------------------------------------------------------------------------------

deadlock_timeout = 5s           # MIQ Value - one second is too low, 5 seconds is more "interesting"
#deadlock_timeout = 1s
#max_locks_per_transaction = 64     # min 10
                    # (change requires restart)
# Note:  Each lock table slot uses ~270 bytes of shared memory, and there are
# max_locks_per_transaction * (max_connections + max_prepared_transactions)
# lock table slots.
#max_pred_locks_per_transaction = 64    # min 10
                    # (change requires restart)

#------------------------------------------------------------------------------
# VERSION/PLATFORM COMPATIBILITY
#------------------------------------------------------------------------------

# - Previous PostgreSQL Versions -

#array_nulls = on
#backslash_quote = safe_encoding    # on, off, or safe_encoding
#default_with_oids = off
escape_string_warning = off     # MIQ Value no sure why this is enabled
#escape_string_warning = on
#lo_compat_privileges = off
#quote_all_identifiers = off
#sql_inheritance = on
standard_conforming_strings = off   # MIQ Value not sure why this is enabled
#standard_conforming_strings = on
#synchronize_seqscans = on

# - Other Platforms and Clients -

#transform_null_equals = off


#------------------------------------------------------------------------------
# ERROR HANDLING
#------------------------------------------------------------------------------

#exit_on_error = off                # terminate session on any error?
#restart_after_crash = on           # reinitialize after backend crash?


#------------------------------------------------------------------------------
# CUSTOMIZED OPTIONS
#------------------------------------------------------------------------------

#custom_variable_classes = ''       # list of custom variable class names
</code></pre></div></div>



      </div>
    </article>
  </div>
</div>

    </main>

    <footer class="site-footer">
  <div class="footer-row" id="footer_top">
    <div class="footer-group">
      <img class="footer-logo" src="/assets/images/manageiq-glyph-inverse.svg" alt="ManageIQ">
      <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

    </div>


    <ul class="contact_menu">
      <li>
        <a href="https://github.com/ManageIQ/">
          <i class="fa fa-github"></i>
          Github
        </a>
      </li>
      <li>
        <a href="https://gitter.im/ManageIQ/manageiq">
          <i class="fa fa-gitter">
            <svg viewBox="45 47 78 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 40.1 (33804) - http://www.bohemiancoding.com/sketch -->
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Artboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(45.000000, 47.000000)">
        <g id="icon-gitter" transform="translate(10.000000, 0.000000)">
            <rect id="Rectangle-path" x="0" y="0.5" width="8.25" height="61"></rect>
            <rect id="Rectangle-path" x="49.75" y="14.5" width="8.25" height="47"></rect>
            <rect id="Rectangle-path" x="16.5" y="14.5" width="8.25" height="80.25"></rect>
            <rect id="Rectangle-path" x="33.25" y="14.5" width="8.25" height="80.25"></rect>
        </g>
    </g>
</svg>

          </i>
          Gitter
        </a>
      </li>
      <li>
        <a href="http://talk.manageiq.org/">
          <i class="fa fa-comments"></i>
          Forum
        </a>
      </li>
    </ul>
  </div>

  <div class="footer-row" id="footer_bottom">
    <div class="footer-legal">
      <span class="copyright">
        &copy; 2020 ManageIQ.
      </span>
      <span>
        <a href="http://community.redhat.com/software/" target="_blank">
          Sponsored by Red Hat, Inc.
        </a>
      </span>
      <span>
        <a href="/logo/" class="footer-link">Logo</a>
      </span>
      <span>
        <a href="/security/" class="footer-link">Security</a>
      </span>
      <span>
        <a href="/legal/" class="footer-link">Legal &amp; Privacy</a>
      </span>
    </div>

    <div class="footer-social">
      <ul class="social_menu">
        <li>
          <a href="https://twitter.com/ManageIQ" class="social_link social_link-twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>

        <li>
          <a href="https://www.facebook.com/manageiq/" class="social_link social_link-facebook">
            <span class="social_link-icon">
              <i class="fa fa-facebook"></i>
            </span>
          </a>
        </li>

        <!--  -->
        <li>
          <a href="https://www.linkedin.com/company/manageiq" class="social_link social_link-linkedin">
            <span class="social_link-icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
        </li>

        <li>
          <a href="https://www.youtube.com/user/ManageIQVideo" class="social_link social_link-youtube">
            <span class="social_link-icon">
              <i class="fa fa-youtube"></i>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    <div id="lightbox">
  <header class="lightbox-header">
    <div class="lightbox-title"></div>
    <div class="lightbox-close">
      <span class="fa fa-times"></span>
    </div>
  </header>

  <div class="lightbox-image">
    <img src="" alt="">
  </div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="/assets/js/main.js" charset="utf-8"></script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58883457-1', 'auto');
  ga('send', 'pageview');

</script>
    
  </body>
</html>
